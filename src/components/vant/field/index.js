'use strict';

var _component = require('./../common/component.js');

(0, _component.VantComponent)({
  field: true,
  classes: ['input-class'],
  props: {
    icon: String,
    label: String,
    error: Boolean,
    fixed: Boolean,
    focus: Boolean,
    center: Boolean,
    isLink: Boolean,
    leftIcon: String,
    disabled: Boolean,
    autosize: Boolean,
    readonly: Boolean,
    required: Boolean,
    iconClass: String,
    clearable: Boolean,
    inputAlign: String,
    customClass: String,
    confirmType: String,
    confirmHold: Boolean,
    errorMessage: String,
    placeholder: String,
    customStyle: String,
    useIconSlot: Boolean,
    useButtonSlot: Boolean,
    showConfirmBar: {
      type: Boolean,
      value: true
    },
    placeholderStyle: String,
    adjustPosition: {
      type: Boolean,
      value: true
    },
    cursorSpacing: {
      type: Number,
      value: 50
    },
    maxlength: {
      type: Number,
      value: -1
    },
    type: {
      type: String,
      value: 'text'
    },
    border: {
      type: Boolean,
      value: true
    },
    titleWidth: {
      type: String,
      value: '90px'
    }
  },
  data: {
    showClear: false
  },
  beforeCreate: function beforeCreate() {
    this.focused = false;
  },
  methods: {
    onInput: function onInput(event) {
      var _this = this;

      var _ref = event.detail || {},
          _ref$value = _ref.value,
          value = _ref$value === void 0 ? '' : _ref$value;

      this.set({
        value: value,
        showClear: this.getShowClear(value)
      }, function () {
        _this.emitChange(value);
      });
    },
    onFocus: function onFocus(event) {
      var _ref2 = event.detail || {},
          _ref2$value = _ref2.value,
          value = _ref2$value === void 0 ? '' : _ref2$value,
          _ref2$height = _ref2.height,
          height = _ref2$height === void 0 ? 0 : _ref2$height;

      this.$emit('focus', {
        value: value,
        height: height
      });
      this.focused = true;
      this.blurFromClear = false;
      this.set({
        showClear: this.getShowClear()
      });
    },
    onBlur: function onBlur(event) {
      var _this2 = this;

      var _ref3 = event.detail || {},
          _ref3$value = _ref3.value,
          value = _ref3$value === void 0 ? '' : _ref3$value,
          _ref3$cursor = _ref3.cursor,
          cursor = _ref3$cursor === void 0 ? 0 : _ref3$cursor;

      this.$emit('blur', {
        value: value,
        cursor: cursor
      });
      this.focused = false;
      var showClear = this.getShowClear();

      if (this.data.value === value) {
        this.set({
          showClear: showClear
        });
      } else if (!this.blurFromClear) {
        // fix: the handwritten keyboard does not trigger input change
        this.set({
          value: value,
          showClear: showClear
        }, function () {
          _this2.emitChange(value);
        });
      }
    },
    onClickIcon: function onClickIcon() {
      this.$emit('click-icon');
    },
    getShowClear: function getShowClear(value) {
      value = value === undefined ? this.data.value : value;
      return this.data.clearable && this.focused && value && !this.data.readonly;
    },
    onClear: function onClear() {
      var _this3 = this;

      this.blurFromClear = true;
      this.set({
        value: '',
        showClear: this.getShowClear('')
      }, function () {
        _this3.emitChange('');

        _this3.$emit('clear', '');
      });
    },
    onConfirm: function onConfirm() {
      this.$emit('confirm', this.data.value);
    },
    emitChange: function emitChange(value) {
      this.$emit('input', value);
      this.$emit('change', value);
    }
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImZpZWxkIiwiY2xhc3NlcyIsInByb3BzIiwiaWNvbiIsIlN0cmluZyIsImxhYmVsIiwiZXJyb3IiLCJCb29sZWFuIiwiZml4ZWQiLCJmb2N1cyIsImNlbnRlciIsImlzTGluayIsImxlZnRJY29uIiwiZGlzYWJsZWQiLCJhdXRvc2l6ZSIsInJlYWRvbmx5IiwicmVxdWlyZWQiLCJpY29uQ2xhc3MiLCJjbGVhcmFibGUiLCJpbnB1dEFsaWduIiwiY3VzdG9tQ2xhc3MiLCJjb25maXJtVHlwZSIsImNvbmZpcm1Ib2xkIiwiZXJyb3JNZXNzYWdlIiwicGxhY2Vob2xkZXIiLCJjdXN0b21TdHlsZSIsInVzZUljb25TbG90IiwidXNlQnV0dG9uU2xvdCIsInNob3dDb25maXJtQmFyIiwidHlwZSIsInZhbHVlIiwicGxhY2Vob2xkZXJTdHlsZSIsImFkanVzdFBvc2l0aW9uIiwiY3Vyc29yU3BhY2luZyIsIk51bWJlciIsIm1heGxlbmd0aCIsImJvcmRlciIsInRpdGxlV2lkdGgiLCJkYXRhIiwic2hvd0NsZWFyIiwiYmVmb3JlQ3JlYXRlIiwiZm9jdXNlZCIsIm1ldGhvZHMiLCJvbklucHV0IiwiZXZlbnQiLCJfdGhpcyIsIl9yZWYiLCJkZXRhaWwiLCJfcmVmJHZhbHVlIiwic2V0IiwiZ2V0U2hvd0NsZWFyIiwiZW1pdENoYW5nZSIsIm9uRm9jdXMiLCJfcmVmMiIsIl9yZWYyJHZhbHVlIiwiX3JlZjIkaGVpZ2h0IiwiaGVpZ2h0IiwiJGVtaXQiLCJibHVyRnJvbUNsZWFyIiwib25CbHVyIiwiX3RoaXMyIiwiX3JlZjMiLCJfcmVmMyR2YWx1ZSIsIl9yZWYzJGN1cnNvciIsImN1cnNvciIsIm9uQ2xpY2tJY29uIiwidW5kZWZpbmVkIiwib25DbGVhciIsIl90aGlzMyIsIm9uQ29uZmlybSJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7QUFDQSw4QkFBYztBQUNaQSxTQUFPLElBREs7QUFFWkMsV0FBUyxDQUFDLGFBQUQsQ0FGRztB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LElBQXVDWCxLQUF2QyxJQUFnRCxDQUFDLEtBQUtRLElBQUwsQ0FBVXZCLFFBQWxFO0FBQ0QsS0FwRU07QUFxRVBvRCxhQUFTLFNBQVNBLE9BQVQsR0FBbUI7QUFDMUIsVUFBSUMsU0FBUyxJQUFiOztBQUVBLFdBQUtWLGFBQUwsR0FBcUIsSUFBckI7QUFDQSxXQUFLVCxHQUFMLENBQVM7QUFDUG5CLGVBQU8sRUFEQTtBQUVQUyxtQkFBVyxLQUFLVyxZQUFMLENBQWtCLEVBQWxCO0FBRkosT0FBVCxFQUdHLFlBQVk7QUFDYmtCLGVBQU9qQixVQUFQLENBQWtCLEVBQWxCOztBQUVBaUIsZUFBT1gsS0FBUCxDQUFhLE9BQWIsRUFBc0IsRUFBdEI7QUFDRCxPQVBEO0FBUUQsS0FqRk07QUFrRlBZLGVBQVcsU0FBU0EsU0FBVCxHQUFxQjtBQUM5QixXQUFLWixLQUFMLENBQVcsU0FBWCxFQUFzQixLQUFLbkIsSUFBTCxDQUFVUixLQUFoQztBQUNELEtBcEZNO0FBcUZQcUIsZ0JBQVksU0FBU0EsVUFBVCxDQUFvQnJCLEtBQXBCLEVBQTJCO0FBQ3JDLFdBQUsyQixLQUFMLENBQVcsT0FBWCxFQUFvQjNCLEtBQXBCO0FBQ0EsV0FBSzJCLEtBQUwsQ0FBVyxRQUFYLEVBQXFCM0IsS0FBckI7QUFDRDtBQXhGTTtBQS9ERyxDQUFkIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVmFudENvbXBvbmVudCB9IGZyb20gJy4uL2NvbW1vbi9jb21wb25lbnQnO1xuVmFudENvbXBvbmVudCh7XG4gIGZpZWxkOiB0cnVlLFxuICBjbGFzc2VzOiBbJ2lucHV0LWNsYXNzJ10sXG4gIHByb3BzOiB7XG4gICAgaWNvbjogU3RyaW5nLFxuICAgIGxhYmVsOiBTdHJpbmcsXG4gICAgZXJyb3I6IEJvb2xlYW4sXG4gICAgZml4ZWQ6IEJvb2xlYW4sXG4gICAgZm9jdXM6IEJvb2xlYW4sXG4gICAgY2VudGVyOiBCb29sZWFuLFxuICAgIGlzTGluazogQm9vbGVhbixcbiAgICBsZWZ0SWNvbjogU3RyaW5nLFxuICAgIGRpc2FibGVkOiBCb29sZWFuLFxuICAgIGF1dG9zaXplOiBCb29sZWFuLFxuICAgIHJlYWRvbmx5OiBCb29sZWFuLFxuICAgIHJlcXVpcmVkOiBCb29sZWFuLFxuICAgIGljb25DbGFzczogU3RyaW5nLFxuICAgIGNsZWFyYWJsZTogQm9vbGVhbixcbiAgICBpbnB1dEFsaWduOiBTdHJpbmcsXG4gICAgY3VzdG9tQ2xhc3M6IFN0cmluZyxcbiAgICBjb25maXJtVHlwZTogU3RyaW5nLFxuICAgIGNvbmZpcm1Ib2xkOiBCb29sZWFuLFxuICAgIGVycm9yTWVzc2FnZTogU3RyaW5nLFxuICAgIHBsYWNlaG9sZGVyOiBTdHJpbmcsXG4gICAgY3VzdG9tU3R5bGU6IFN0cmluZyxcbiAgICB1c2VJY29uU2xvdDogQm9vbGVhbixcbiAgICB1c2VCdXR0b25TbG90OiBCb29sZWFuLFxuICAgIHNob3dDb25maXJtQmFyOiB7XG4gICAgICB0eXBlOiBCb29sZWFuLFxuICAgICAgdmFsdWU6IHRydWVcbiAgICB9LFxuICAgIHBsYWNlaG9sZGVyU3R5bGU6IFN0cmluZyxcbiAgICBhZGp1c3RQb3NpdGlvbjoge1xuICAgICAgdHlwZTogQm9vbGVhbixcbiAgICAgIHZhbHVlOiB0cnVlXG4gICAgfSxcbiAgICBjdXJzb3JTcGFjaW5nOiB7XG4gICAgICB0eXBlOiBOdW1iZXIsXG4gICAgICB2YWx1ZTogNTBcbiAgICB9LFxuICAgIG1heGxlbmd0aDoge1xuICAgICAgdHlwZTogTnVtYmVyLFxuICAgICAgdmFsdWU6IC0xXG4gICAgfSxcbiAgICB0eXBlOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICB2YWx1ZTogJ3RleHQnXG4gICAgfSxcbiAgICBib3JkZXI6IHtcbiAgICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgICB2YWx1ZTogdHJ1ZVxuICAgIH0sXG4gICAgdGl0bGVXaWR0aDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgdmFsdWU6ICc5MHB4J1xuICAgIH1cbiAgfSxcbiAgZGF0YToge1xuICAgIHNob3dDbGVhcjogZmFsc2VcbiAgfSxcbiAgYmVmb3JlQ3JlYXRlOiBmdW5jdGlvbiBiZWZvcmVDcmVhdGUoKSB7XG4gICAgdGhpcy5mb2N1c2VkID0gZmFsc2U7XG4gIH0sXG4gIG1ldGhvZHM6IHtcbiAgICBvbklucHV0OiBmdW5jdGlvbiBvbklucHV0KGV2ZW50KSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICB2YXIgX3JlZiA9IGV2ZW50LmRldGFpbCB8fCB7fSxcbiAgICAgICAgICBfcmVmJHZhbHVlID0gX3JlZi52YWx1ZSxcbiAgICAgICAgICB2YWx1ZSA9IF9yZWYkdmFsdWUgPT09IHZvaWQgMCA/ICcnIDogX3JlZiR2YWx1ZTtcblxuICAgICAgdGhpcy5zZXQoe1xuICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgIHNob3dDbGVhcjogdGhpcy5nZXRTaG93Q2xlYXIodmFsdWUpXG4gICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzLmVtaXRDaGFuZ2UodmFsdWUpO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBvbkZvY3VzOiBmdW5jdGlvbiBvbkZvY3VzKGV2ZW50KSB7XG4gICAgICB2YXIgX3JlZjIgPSBldmVudC5kZXRhaWwgfHwge30sXG4gICAgICAgICAgX3JlZjIkdmFsdWUgPSBfcmVmMi52YWx1ZSxcbiAgICAgICAgICB2YWx1ZSA9IF9yZWYyJHZhbHVlID09PSB2b2lkIDAgPyAnJyA6IF9yZWYyJHZhbHVlLFxuICAgICAgICAgIF9yZWYyJGhlaWdodCA9IF9yZWYyLmhlaWdodCxcbiAgICAgICAgICBoZWlnaHQgPSBfcmVmMiRoZWlnaHQgPT09IHZvaWQgMCA/IDAgOiBfcmVmMiRoZWlnaHQ7XG5cbiAgICAgIHRoaXMuJGVtaXQoJ2ZvY3VzJywge1xuICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgIGhlaWdodDogaGVpZ2h0XG4gICAgICB9KTtcbiAgICAgIHRoaXMuZm9jdXNlZCA9IHRydWU7XG4gICAgICB0aGlzLmJsdXJGcm9tQ2xlYXIgPSBmYWxzZTtcbiAgICAgIHRoaXMuc2V0KHtcbiAgICAgICAgc2hvd0NsZWFyOiB0aGlzLmdldFNob3dDbGVhcigpXG4gICAgICB9KTtcbiAgICB9LFxuICAgIG9uQmx1cjogZnVuY3Rpb24gb25CbHVyKGV2ZW50KSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgdmFyIF9yZWYzID0gZXZlbnQuZGV0YWlsIHx8IHt9LFxuICAgICAgICAgIF9yZWYzJHZhbHVlID0gX3JlZjMudmFsdWUsXG4gICAgICAgICAgdmFsdWUgPSBfcmVmMyR2YWx1ZSA9PT0gdm9pZCAwID8gJycgOiBfcmVmMyR2YWx1ZSxcbiAgICAgICAgICBfcmVmMyRjdXJzb3IgPSBfcmVmMy5jdXJzb3IsXG4gICAgICAgICAgY3Vyc29yID0gX3JlZjMkY3Vyc29yID09PSB2b2lkIDAgPyAwIDogX3JlZjMkY3Vyc29yO1xuXG4gICAgICB0aGlzLiRlbWl0KCdibHVyJywge1xuICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgIGN1cnNvcjogY3Vyc29yXG4gICAgICB9KTtcbiAgICAgIHRoaXMuZm9jdXNlZCA9IGZhbHNlO1xuICAgICAgdmFyIHNob3dDbGVhciA9IHRoaXMuZ2V0U2hvd0NsZWFyKCk7XG5cbiAgICAgIGlmICh0aGlzLmRhdGEudmFsdWUgPT09IHZhbHVlKSB7XG4gICAgICAgIHRoaXMuc2V0KHtcbiAgICAgICAgICBzaG93Q2xlYXI6IHNob3dDbGVhclxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoIXRoaXMuYmx1ckZyb21DbGVhcikge1xuICAgICAgICAvLyBmaXg6IHRoZSBoYW5kd3JpdHRlbiBrZXlib2FyZCBkb2VzIG5vdCB0cmlnZ2VyIGlucHV0IGNoYW5nZVxuICAgICAgICB0aGlzLnNldCh7XG4gICAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICAgIHNob3dDbGVhcjogc2hvd0NsZWFyXG4gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfdGhpczIuZW1pdENoYW5nZSh2YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgb25DbGlja0ljb246IGZ1bmN0aW9uIG9uQ2xpY2tJY29uKCkge1xuICAgICAgdGhpcy4kZW1pdCgnY2xpY2staWNvbicpO1xuICAgIH0sXG4gICAgZ2V0U2hvd0NsZWFyOiBmdW5jdGlvbiBnZXRTaG93Q2xlYXIodmFsdWUpIHtcbiAgICAgIHZhbHVlID0gdmFsdWUgPT09IHVuZGVmaW5lZCA/IHRoaXMuZGF0YS52YWx1ZSA6IHZhbHVlO1xuICAgICAgcmV0dXJuIHRoaXMuZGF0YS5jbGVhcmFibGUgJiYgdGhpcy5mb2N1c2VkICYmIHZhbHVlICYmICF0aGlzLmRhdGEucmVhZG9ubHk7XG4gICAgfSxcbiAgICBvbkNsZWFyOiBmdW5jdGlvbiBvbkNsZWFyKCkge1xuICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgIHRoaXMuYmx1ckZyb21DbGVhciA9IHRydWU7XG4gICAgICB0aGlzLnNldCh7XG4gICAgICAgIHZhbHVlOiAnJyxcbiAgICAgICAgc2hvd0NsZWFyOiB0aGlzLmdldFNob3dDbGVhcignJylcbiAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMzLmVtaXRDaGFuZ2UoJycpO1xuXG4gICAgICAgIF90aGlzMy4kZW1pdCgnY2xlYXInLCAnJyk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIG9uQ29uZmlybTogZnVuY3Rpb24gb25Db25maXJtKCkge1xuICAgICAgdGhpcy4kZW1pdCgnY29uZmlybScsIHRoaXMuZGF0YS52YWx1ZSk7XG4gICAgfSxcbiAgICBlbWl0Q2hhbmdlOiBmdW5jdGlvbiBlbWl0Q2hhbmdlKHZhbHVlKSB7XG4gICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIHZhbHVlKTtcbiAgICAgIHRoaXMuJGVtaXQoJ2NoYW5nZScsIHZhbHVlKTtcbiAgICB9XG4gIH1cbn0pOyJdfQ==