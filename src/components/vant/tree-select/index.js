'use strict';

var _component = require('./../common/component.js');

var ITEM_HEIGHT = 44;
(0, _component.VantComponent)({
  classes: ['main-item-class', 'content-item-class', 'main-active-class', 'content-active-class', 'main-disabled-class', 'content-disabled-class'],
  props: {
    items: Array,
    mainActiveIndex: {
      type: Number,
      value: 0
    },
    activeId: {
      type: [Number, String]
    },
    maxHeight: {
      type: Number,
      value: 300
    }
  },
  data: {
    subItems: [],
    mainHeight: 0,
    itemHeight: 0
  },
  watch: {
    items: function items() {
      var _this = this;

      this.updateSubItems().then(function () {
        _this.updateMainHeight();
      });
    },
    maxHeight: function maxHeight() {
      this.updateItemHeight(this.data.subItems);
      this.updateMainHeight();
    },
    mainActiveIndex: 'updateSubItems'
  },
  methods: {
    // 当一个子项被选择时
    onSelectItem: function onSelectItem(event) {
      var item = event.currentTarget.dataset.item;

      if (!item.disabled) {
        this.$emit('click-item', item);
      }
    },
    // 当一个导航被点击时
    onClickNav: function onClickNav(event) {
      var index = event.currentTarget.dataset.index;
      var item = this.data.items[index];

      if (!item.disabled) {
        this.$emit('click-nav', {
          index: index
        });
      }
    },
    // 更新子项列表
    updateSubItems: function updateSubItems() {
      var _this$data = this.data,
          items = _this$data.items,
          mainActiveIndex = _this$data.mainActiveIndex;

      var _ref = items[mainActiveIndex] || {},
          _ref$children = _ref.children,
          children = _ref$children === void 0 ? [] : _ref$children;

      this.updateItemHeight(children);
      return this.set({
        subItems: children
      });
    },
    // 更新组件整体高度，根据最大高度和当前组件需要展示的高度来决定
    updateMainHeight: function updateMainHeight() {
      var _this$data2 = this.data,
          _this$data2$items = _this$data2.items,
          items = _this$data2$items === void 0 ? [] : _this$data2$items,
          _this$data2$subItems = _this$data2.subItems,
          subItems = _this$data2$subItems === void 0 ? [] : _this$data2$subItems;
      var maxHeight = Math.max(items.length * ITEM_HEIGHT, subItems.length * ITEM_HEIGHT);
      this.set({
        mainHeight: Math.min(maxHeight, this.data.maxHeight)
      });
    },
    // 更新子项列表高度，根据可展示的最大高度和当前子项列表的高度决定
    updateItemHeight: function updateItemHeight(subItems) {
      var itemHeight = Math.min(subItems.length * ITEM_HEIGHT, this.data.maxHeight);
      return this.set({
        itemHeight: itemHeight
      });
    }
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIklURU1fSEVJR0hUIiwiY2xhc3NlcyIsInByb3BzIiwiaXRlbXMiLCJBcnJheSIsIm1haW5BY3RpdmVJbmRleCIsInR5cGUiLCJOdW1iZXIiLCJ2YWx1ZSIsImFjdGl2ZUlkIiwiU3RyaW5nIiwibWF4SGVpZ2h0IiwiZGF0YSIsInN1Ykl0ZW1zIiwibWFpbkhlaWdodCIsIml0ZW1IZWlnaHQiLCJ3YXRjaCIsIl90aGlzIiwidXBkYXRlU3ViSXRlbXMiLCJ0aGVuIiwidXBkYXRlTWFpbkhlaWdodCIsInVwZGF0ZUl0ZW1IZWlnaHQiLCJtZXRob2RzIiwib25TZWxlY3RJdGVtIiwiZXZlbnQiLCJpdGVtIiwiY3VycmVudFRhcmdldCIsImRhdGFzZXQiLCJkaXNhYmxlZCIsIiRlbWl0Iiwib25DbGlja05hdiIsImluZGV4IiwiX3RoaXMkZGF0YSIsIl9yZWYiLCJfcmVmJGNoaWxkcmVuIiwiY2hpbGRyZW4iLCJzZXQiLCJfdGhpcyRkYXRhMiIsIl90aGlzJGRhdGEyJGl0ZW1zIiwiX3RoaXMkZGF0YTIkc3ViSXRlbXMiLCJNYXRoIiwibWF4IiwibGVuZ3RoIiwibWluIl0sIm1hcHBpbmdzIjoiOztBQUFBOztBQUNBLElBQUlBLGNBQWMsRUFBbEI7QUFDQSw4QkFBYztBQUNaQyxXQUFTLENBQUMsaUJBQUQsRUFBb0Isb0JBQXBCLEVBQTBDLG1CQUExQyxFQUErRCxzQkFBL0QsRUFBdUYscUJBQXZGLEVBQThHLHdCQUE5RyxDQURHO0FBRVpDLFNBQU87QUFDTEMsV0FBT0MsS0FERjtBQUVMQyxxQkFBaUI7QUFDZkMsWUFBTUMsTUFEUztBQUVmQyxhQUFPO0FBRlEsS0FGWjtBQU1MQyxjQUFVO0FBQ1JILFlBQU0sQ0FBQ0MsTUFBRCxFQUFTRyxNQUFUO0FBREUsS0FOTDtBQVNMQyxlQUFXO0FBQ1RMLFlBQU1DLE1BREc7QUFFVEMsYUFBTztBQUZFO0FBVE4sR0FGSztBQWdCWkksUUFBTTtBQUNKQyxjQUFVLEVBRE47QUFFSkMs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QVQsQ0FBUDtBQUdEO0FBckRNO0FBbkNHLENBQWQiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWYW50Q29tcG9uZW50IH0gZnJvbSAnLi4vY29tbW9uL2NvbXBvbmVudCc7XG52YXIgSVRFTV9IRUlHSFQgPSA0NDtcblZhbnRDb21wb25lbnQoe1xuICBjbGFzc2VzOiBbJ21haW4taXRlbS1jbGFzcycsICdjb250ZW50LWl0ZW0tY2xhc3MnLCAnbWFpbi1hY3RpdmUtY2xhc3MnLCAnY29udGVudC1hY3RpdmUtY2xhc3MnLCAnbWFpbi1kaXNhYmxlZC1jbGFzcycsICdjb250ZW50LWRpc2FibGVkLWNsYXNzJ10sXG4gIHByb3BzOiB7XG4gICAgaXRlbXM6IEFycmF5LFxuICAgIG1haW5BY3RpdmVJbmRleDoge1xuICAgICAgdHlwZTogTnVtYmVyLFxuICAgICAgdmFsdWU6IDBcbiAgICB9LFxuICAgIGFjdGl2ZUlkOiB7XG4gICAgICB0eXBlOiBbTnVtYmVyLCBTdHJpbmddXG4gICAgfSxcbiAgICBtYXhIZWlnaHQ6IHtcbiAgICAgIHR5cGU6IE51bWJlcixcbiAgICAgIHZhbHVlOiAzMDBcbiAgICB9XG4gIH0sXG4gIGRhdGE6IHtcbiAgICBzdWJJdGVtczogW10sXG4gICAgbWFpbkhlaWdodDogMCxcbiAgICBpdGVtSGVpZ2h0OiAwXG4gIH0sXG4gIHdhdGNoOiB7XG4gICAgaXRlbXM6IGZ1bmN0aW9uIGl0ZW1zKCkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgdGhpcy51cGRhdGVTdWJJdGVtcygpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpcy51cGRhdGVNYWluSGVpZ2h0KCk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIG1heEhlaWdodDogZnVuY3Rpb24gbWF4SGVpZ2h0KCkge1xuICAgICAgdGhpcy51cGRhdGVJdGVtSGVpZ2h0KHRoaXMuZGF0YS5zdWJJdGVtcyk7XG4gICAgICB0aGlzLnVwZGF0ZU1haW5IZWlnaHQoKTtcbiAgICB9LFxuICAgIG1haW5BY3RpdmVJbmRleDogJ3VwZGF0ZVN1Ykl0ZW1zJ1xuICB9LFxuICBtZXRob2RzOiB7XG4gICAgLy8g5b2T5LiA5Liq5a2Q6aG56KKr6YCJ5oup5pe2XG4gICAgb25TZWxlY3RJdGVtOiBmdW5jdGlvbiBvblNlbGVjdEl0ZW0oZXZlbnQpIHtcbiAgICAgIHZhciBpdGVtID0gZXZlbnQuY3VycmVudFRhcmdldC5kYXRhc2V0Lml0ZW07XG5cbiAgICAgIGlmICghaXRlbS5kaXNhYmxlZCkge1xuICAgICAgICB0aGlzLiRlbWl0KCdjbGljay1pdGVtJywgaXRlbSk7XG4gICAgICB9XG4gICAgfSxcbiAgICAvLyDlvZPkuIDkuKrlr7zoiKrooqvngrnlh7vml7ZcbiAgICBvbkNsaWNrTmF2OiBmdW5jdGlvbiBvbkNsaWNrTmF2KGV2ZW50KSB7XG4gICAgICB2YXIgaW5kZXggPSBldmVudC5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaW5kZXg7XG4gICAgICB2YXIgaXRlbSA9IHRoaXMuZGF0YS5pdGVtc1tpbmRleF07XG5cbiAgICAgIGlmICghaXRlbS5kaXNhYmxlZCkge1xuICAgICAgICB0aGlzLiRlbWl0KCdjbGljay1uYXYnLCB7XG4gICAgICAgICAgaW5kZXg6IGluZGV4XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgLy8g5pu05paw5a2Q6aG55YiX6KGoXG4gICAgdXBkYXRlU3ViSXRlbXM6IGZ1bmN0aW9uIHVwZGF0ZVN1Ykl0ZW1zKCkge1xuICAgICAgdmFyIF90aGlzJGRhdGEgPSB0aGlzLmRhdGEsXG4gICAgICAgICAgaXRlbXMgPSBfdGhpcyRkYXRhLml0ZW1zLFxuICAgICAgICAgIG1haW5BY3RpdmVJbmRleCA9IF90aGlzJGRhdGEubWFpbkFjdGl2ZUluZGV4O1xuXG4gICAgICB2YXIgX3JlZiA9IGl0ZW1zW21haW5BY3RpdmVJbmRleF0gfHwge30sXG4gICAgICAgICAgX3JlZiRjaGlsZHJlbiA9IF9yZWYuY2hpbGRyZW4sXG4gICAgICAgICAgY2hpbGRyZW4gPSBfcmVmJGNoaWxkcmVuID09PSB2b2lkIDAgPyBbXSA6IF9yZWYkY2hpbGRyZW47XG5cbiAgICAgIHRoaXMudXBkYXRlSXRlbUhlaWdodChjaGlsZHJlbik7XG4gICAgICByZXR1cm4gdGhpcy5zZXQoe1xuICAgICAgICBzdWJJdGVtczogY2hpbGRyZW5cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgLy8g5pu05paw57uE5Lu25pW05L2T6auY5bqm77yM5qC55o2u5pyA5aSn6auY5bqm5ZKM5b2T5YmN57uE5Lu26ZyA6KaB5bGV56S655qE6auY5bqm5p2l5Yaz5a6aXG4gICAgdXBkYXRlTWFpbkhlaWdodDogZnVuY3Rpb24gdXBkYXRlTWFpbkhlaWdodCgpIHtcbiAgICAgIHZhciBfdGhpcyRkYXRhMiA9IHRoaXMuZGF0YSxcbiAgICAgICAgICBfdGhpcyRkYXRhMiRpdGVtcyA9IF90aGlzJGRhdGEyLml0ZW1zLFxuICAgICAgICAgIGl0ZW1zID0gX3RoaXMkZGF0YTIkaXRlbXMgPT09IHZvaWQgMCA/IFtdIDogX3RoaXMkZGF0YTIkaXRlbXMsXG4gICAgICAgICAgX3RoaXMkZGF0YTIkc3ViSXRlbXMgPSBfdGhpcyRkYXRhMi5zdWJJdGVtcyxcbiAgICAgICAgICBzdWJJdGVtcyA9IF90aGlzJGRhdGEyJHN1Ykl0ZW1zID09PSB2b2lkIDAgPyBbXSA6IF90aGlzJGRhdGEyJHN1Ykl0ZW1zO1xuICAgICAgdmFyIG1heEhlaWdodCA9IE1hdGgubWF4KGl0ZW1zLmxlbmd0aCAqIElURU1fSEVJR0hULCBzdWJJdGVtcy5sZW5ndGggKiBJVEVNX0hFSUdIVCk7XG4gICAgICB0aGlzLnNldCh7XG4gICAgICAgIG1haW5IZWlnaHQ6IE1hdGgubWluKG1heEhlaWdodCwgdGhpcy5kYXRhLm1heEhlaWdodClcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgLy8g5pu05paw5a2Q6aG55YiX6KGo6auY5bqm77yM5qC55o2u5Y+v5bGV56S655qE5pyA5aSn6auY5bqm5ZKM5b2T5YmN5a2Q6aG55YiX6KGo55qE6auY5bqm5Yaz5a6aXG4gICAgdXBkYXRlSXRlbUhlaWdodDogZnVuY3Rpb24gdXBkYXRlSXRlbUhlaWdodChzdWJJdGVtcykge1xuICAgICAgdmFyIGl0ZW1IZWlnaHQgPSBNYXRoLm1pbihzdWJJdGVtcy5sZW5ndGggKiBJVEVNX0hFSUdIVCwgdGhpcy5kYXRhLm1heEhlaWdodCk7XG4gICAgICByZXR1cm4gdGhpcy5zZXQoe1xuICAgICAgICBpdGVtSGVpZ2h0OiBpdGVtSGVpZ2h0XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pOyJdfQ==